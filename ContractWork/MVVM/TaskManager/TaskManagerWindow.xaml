<Window x:Class="ContractWork.MVVM.TaskManager.TaskManagerWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ContractWork.MVVM.TaskManager"
        mc:Ignorable="d"
        xmlns:converters="clr-namespace:ContractWork.Converters"
        xmlns:customcontrols="clr-namespace:ContractWork.CustomControls"
        xmlns:i="http://schemas.microsoft.com/xaml/behaviors" 
        
        d:DataContext="{d:DesignInstance Type=local:TaskManagerViewModel}"
        
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        
        Height="800"
        Width="1050"
        WindowStartupLocation="CenterScreen"
        x:Name="TaskSheet"
        MouseLeftButtonDown="DragMe">
    <Window.Resources>
        <converters:CloneMultiConverter x:Key="twoParameters"/>

        <!--MinusOrPlusConverter x:Key="MinusOrPlus"/>-->
        
    </Window.Resources>


    <Border CornerRadius="10"
        BorderBrush="White"
        BorderThickness="3"
            Background="DarkGray">

        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="5" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width=".13*" />
                <ColumnDefinition Width="5" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="5" />
                <RowDefinition Height=".07*" />
                <RowDefinition Height=".9*" />
                <RowDefinition Height="5" />
            </Grid.RowDefinitions>

            <Border Grid.Column="1" Grid.ColumnSpan="2" Grid.Row="1" 
                    Background="AntiqueWhite"
                    CornerRadius="9,9,0,0">

                <StackPanel Orientation="Horizontal">
                    <TextBlock 
                         Foreground="#385578"
                         Text="Task Manager: "
                         VerticalAlignment="Center"
                         HorizontalAlignment="Left"
                         Margin="20,0,0,5"
                         FontSize="32" 
                    />

                    <customcontrols:btnRoundedGelControl
                        mainColor="BlanchedAlmond"
                        offsetColor="Coral"
                        transparentColor="{StaticResource btnGelLike}"
                        btngelHeight="30"
                        btngelWidth="80"
                        textContent="New Task"
                        Margin="20,0,0,3"
                        RectRadiusX="10"
                        RectRadiusY="10"
                        btngelCommand="{Binding NewTaskCommand}"
                    />

                    <customcontrols:btnRoundedGelControl
                        mainColor="BlanchedAlmond"
                        offsetColor="Coral"
                        transparentColor="{StaticResource btnGelLike}"
                        btngelHeight="30"
                        btngelWidth="80"
                        textContent="Edit Task"
                        Margin="20,0,0,3"
                        RectRadiusX="10"
                        RectRadiusY="10"
                        btngelCommand="{Binding EditTaskCommand}"
                    />  
                </StackPanel>
            </Border>

            <StackPanel Orientation="Horizontal" Margin="5,15,0,0"
                        Grid.Column="1" Grid.Row="1"
                        HorizontalAlignment="Right">
                <Label Content="Tasks:"  />
                <CheckBox Content="{Binding TasksViewingby}" Margin="0,7,0,0"
                    d:Content="Viewing Current"
                    IsChecked="{Binding IsCheckedTasksArchived}"
                    Command="{Binding IncludeArchivedTasksCommand}"
                    IsThreeState="True">
                </CheckBox>
            </StackPanel>

            <Grid Grid.Column="2"
                    Grid.Row="1">
                <StackPanel Orientation="Horizontal">
                    <customcontrols:WindowControls
                        TextContent="-"
                        btnWidth="20"
                        btnMargin="3"
                        btnBckgrnd="#F5B53F"
                        btnClick="btnMinimize_Click"
                        Margin="60,0,0,20"
                        />

                    <customcontrols:WindowControls
                        TextContent="X"
                        TextPadding="1,0,1,2"
                        btnWidth="20"
                        btnMargin="3"
                        btnBckgrnd="#F55551"
                        btnClick="btnExit_Click"
                        Margin="0,0,0,20"
                        />

                </StackPanel>
            </Grid>

            <Grid Grid.Column="1" Grid.ColumnSpan="2" Grid.Row="2">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width=".2*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height=".2*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height=".2*"/>
                        <RowDefinition Height=".3*"/>
                    </Grid.RowDefinitions>

                    <DataGrid x:Name="DGTaskList"
                            Grid.Row="0" Grid.RowSpan="2"
                            Grid.Column="0" Grid.ColumnSpan="2"
                            Background="AntiqueWhite"
                            BorderThickness="1,0,1,0" BorderBrush="White"
                            ItemsSource="{Binding TaskList}"
                              SelectedItem="{Binding SelectedTask}"
                            RowHeight="20"
                            AutoGenerateColumns="False">
                        

                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Task ID" Width="50" Binding="{Binding taskID}"/>
                            <DataGridTextColumn Header="Customer ID" Width="80" Binding="{Binding customerID}"/>
                            <DataGridTextColumn Header="Customer" Width="200" Binding="{Binding customerName}"/>
                            <DataGridTextColumn Header="Description" Width="200" Binding="{Binding description}"/>
                            <DataGridTextColumn Header="Start Date" Width="100" Binding="{Binding dateStarted,
                                StringFormat='{}{0:MM/dd/yyyy}'}"/>
                            <DataGridTextColumn Header="Due Date" Width="100" Binding="{Binding dateDue,
                                StringFormat='{}{0:MM/dd/yyyy}'}"/>
                            <DataGridTextColumn Header="Date Completed" Width="100" Binding="{Binding dateCompleted,
                                StringFormat='{}{0:MM/dd/yyyy}'}"/>
                            <DataGridTextColumn Header="Importance" Width="100" Binding="{Binding rating}"/>

                            <DataGridTemplateColumn Header="Is Completed" Width="100">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <CheckBox IsChecked="{Binding IsCompleted, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            Command="{Binding Path=DataContext.CheckCommand,
                                            UpdateSourceTrigger=PropertyChanged, 
                                            RelativeSource={RelativeSource FindAncestor,
                                            AncestorType={x:Type Window}}}">
                                            <CheckBox.CommandParameter>
                                                <MultiBinding Converter="{StaticResource twoParameters}">
                                                    <Binding Path="taskID"/>
                                                    <Binding Path="IsCompleted"/>

                                                </MultiBinding>
                                            </CheckBox.CommandParameter>
                                        </CheckBox>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>

                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="SelectionChanged">
                                <i:InvokeCommandAction Command="{Binding TaskPickedCommand}"/>
                            </i:EventTrigger>
                            <i:EventTrigger EventName="MouseDoubleClick">
                                <i:InvokeCommandAction Command="{Binding EditTaskCommand}"/>
                            </i:EventTrigger>
                        </i:Interaction.Triggers>

                    </DataGrid>

                    <!--<DataGrid Style="{StaticResource roundedDataGrid}"
                            Grid.Row="2" Grid.RowSpan="2"
                            Grid.Column="0" Grid.ColumnSpan="2"
                            VerticalAlignment="Bottom"
                            Margin="0,1,0,0"
                            Height="510" 
                        
                            AutoGenerateColumns="True"
                            VirtualizingPanel.IsVirtualizing="False"
                            BorderBrush="White">

                    </DataGrid>
                    <Label Grid.Row="2" Grid.Column="0"
                                Content="Description:" />-->


                    <DockPanel Grid.Row="2" Grid.RowSpan="2" Grid.Column="0" Grid.ColumnSpan="2" Margin="0,2,0,0"
                               LastChildFill="True">
                        <!--<Border DockPanel.Dock="top"
                            Background="WhiteSmoke"
                            CornerRadius="20,20,0,0"
                            BorderThickness="2,2,2,0"
                            BorderBrush="White"
                            Margin="0,0">-->
                        <Menu Background="WhiteSmoke" DockPanel.Dock="top">
                            <Menu.Items>
                                <MenuItem Header="Format" Margin="5,10,2,0" FontSize="16">
                                    <MenuItem Header="Font" Margin="2,10,2,0" FontSize="14"/>
                                    <MenuItem Header="Word Wrap" Margin="2,10,2,0" FontSize="14"/>
                                </MenuItem>
                                <MenuItem Header="Save" Margin="5,10,2,0" FontSize="16" Command="{Binding CustomerAccount.LostFocusCompareValueCommand}"/>

                                <MenuItem Header="Undo" Margin="120,10,2,0" FontSize="16" Command="{Binding CustomerAccount.UndoCommand}"/>
                            </Menu.Items>
                        </Menu>
                        <!--</Border>-->

                        <!--<Border CornerRadius="0,0,10,10"
                            Background="Wheat"
                            VerticalAlignment="Top"
                            HorizontalAlignment="Left"
                            BorderBrush="White"
                            BorderThickness="2,0,0,2"
                                >-->

                            <TextBox  DockPanel.Dock="Bottom"
                                 Background="Wheat"
                                 BorderBrush="Transparent"
                                 FontSize="14"
                                 TextWrapping="Wrap"
                                 Margin="0,0,0,0"
                                 VerticalScrollBarVisibility="Visible"
                                 AcceptsReturn="True"
                                 Text="{Binding SelectedNote, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">

                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="LostFocus">
                                        <i:InvokeCommandAction Command="{Binding SelectedTask.LostFocusCompareValueCommand}" 
                                                               CommandParameter="{Binding SelectedNote}"/>
                                    </i:EventTrigger>
                                    <i:EventTrigger EventName="GotFocus">
                                    <i:InvokeCommandAction Command="{Binding SelectedTask.GotFocusInitialValueCommand}" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                            </TextBox>
                        <!--</Border>-->
                    </DockPanel>

                </Grid>
            </Grid>

        </Grid>
    </Border>
</Window>
